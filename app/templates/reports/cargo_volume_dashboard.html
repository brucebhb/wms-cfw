{% extends "base.html" %}
{% set title = "货量报表仪表板" %}

{% block content %}
<div class="container-fluid cargo-volume-dashboard">
    <!-- 页面标题 -->
    <div class="row mb-4">
        <div class="col-12">
            <div class="d-flex justify-content-between align-items-center">
                <div>
                    <h2 class="mb-1">
                        <i class="fas fa-truck-loading text-primary"></i>
                        货量报表仪表板
                    </h2>
                    <p class="text-muted mb-0">实时货量数据分析和可视化展示</p>
                </div>
                <div>
                    <span class="badge bg-success">实时更新</span>
                    <span id="lastUpdateTime" class="text-muted ms-2"></span>
                </div>
            </div>
        </div>
    </div>

    <!-- 时间维度选择器 -->
    <div class="row mb-4">
        <div class="col-12">
            <div class="card">
                <div class="card-body py-3">
                    <div class="d-flex justify-content-between align-items-center mb-3">
                        <div class="btn-group" role="group" id="timePeriodSelector">
                            <input type="radio" class="btn-check" name="timePeriod" id="dayPeriod" value="day" autocomplete="off" checked>
                            <label class="btn btn-outline-primary period-btn" for="dayPeriod">
                                <i class="fas fa-calendar-day"></i> 日对比
                            </label>

                            <input type="radio" class="btn-check" name="timePeriod" id="weekPeriod" value="week" autocomplete="off">
                            <label class="btn btn-outline-primary period-btn" for="weekPeriod">
                                <i class="fas fa-calendar-week"></i> 周对比
                            </label>

                            <input type="radio" class="btn-check" name="timePeriod" id="monthPeriod" value="month" autocomplete="off">
                            <label class="btn btn-outline-primary period-btn" for="monthPeriod">
                                <i class="fas fa-calendar-alt"></i> 月对比
                            </label>

                            <input type="radio" class="btn-check" name="timePeriod" id="yearPeriod" value="year" autocomplete="off">
                            <label class="btn btn-outline-primary period-btn" for="yearPeriod">
                                <i class="fas fa-calendar"></i> 年对比
                            </label>
                        </div>
                        <div>
                            <button class="btn btn-outline-secondary" id="refreshBtn">
                                <i class="fas fa-sync-alt"></i> 刷新数据
                            </button>
                        </div>
                    </div>

                    <!-- 时间选择器区域 -->
                    <div id="timeSelectionArea" class="mb-3">
                        <!-- 日对比选择器 -->
                        <div id="daySelection" class="time-selector">
                            <div class="row g-2 align-items-end">
                                <div class="col-md-3">
                                    <label class="form-label small">开始日期</label>
                                    <input type="date" class="form-control form-control-sm" id="dayStartDate">
                                </div>
                                <div class="col-md-3">
                                    <label class="form-label small">结束日期</label>
                                    <input type="date" class="form-control form-control-sm" id="dayEndDate">
                                </div>
                                <div class="col-md-2">
                                    <button class="btn btn-primary btn-sm w-100" id="dayQueryBtn">
                                        <i class="fas fa-search"></i> 查询
                                    </button>
                                </div>
                                <div class="col-md-4">
                                    <small class="text-muted">最多可选择7天数据</small>
                                </div>
                            </div>
                        </div>

                        <!-- 周对比选择器 -->
                        <div id="weekSelection" class="time-selector" style="display: none;">
                            <div class="row g-3">
                                <!-- 第一周 -->
                                <div class="col-md-6">
                                    <div class="card border-primary">
                                        <div class="card-header bg-primary text-white py-2">
                                            <h6 class="mb-0">
                                                <i class="fas fa-calendar-week"></i> 第一周
                                            </h6>
                                        </div>
                                        <div class="card-body">
                                            <div class="row g-2">
                                                <div class="col-4">
                                                    <label class="form-label small">年份</label>
                                                    <select class="form-select form-select-sm" id="weekFirstYear">
                                                        <!-- 动态生成年份选项 -->
                                                    </select>
                                                </div>
                                                <div class="col-4">
                                                    <label class="form-label small">月份</label>
                                                    <select class="form-select form-select-sm" id="weekFirstMonth">
                                                        <option value="1">1月</option>
                                                        <option value="2">2月</option>
                                                        <option value="3">3月</option>
                                                        <option value="4">4月</option>
                                                        <option value="5">5月</option>
                                                        <option value="6">6月</option>
                                                        <option value="7">7月</option>
                                                        <option value="8">8月</option>
                                                        <option value="9">9月</option>
                                                        <option value="10">10月</option>
                                                        <option value="11">11月</option>
                                                        <option value="12">12月</option>
                                                    </select>
                                                </div>
                                                <div class="col-4">
                                                    <label class="form-label small">第几周</label>
                                                    <select class="form-select form-select-sm" id="weekFirstWeek">
                                                        <!-- 动态生成周次选项 -->
                                                    </select>
                                                </div>
                                            </div>
                                            <div class="mt-2">
                                                <small class="text-muted" id="weekFirstRange">选择周次后显示日期</small>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- 第二周 -->
                                <div class="col-md-6">
                                    <div class="card border-success">
                                        <div class="card-header bg-success text-white py-2">
                                            <h6 class="mb-0">
                                                <i class="fas fa-calendar-week"></i> 第二周
                                            </h6>
                                        </div>
                                        <div class="card-body">
                                            <div class="row g-2">
                                                <div class="col-4">
                                                    <label class="form-label small">年份</label>
                                                    <select class="form-select form-select-sm" id="weekSecondYear">
                                                        <!-- 动态生成年份选项 -->
                                                    </select>
                                                </div>
                                                <div class="col-4">
                                                    <label class="form-label small">月份</label>
                                                    <select class="form-select form-select-sm" id="weekSecondMonth">
                                                        <option value="1">1月</option>
                                                        <option value="2">2月</option>
                                                        <option value="3">3月</option>
                                                        <option value="4">4月</option>
                                                        <option value="5">5月</option>
                                                        <option value="6">6月</option>
                                                        <option value="7">7月</option>
                                                        <option value="8">8月</option>
                                                        <option value="9">9月</option>
                                                        <option value="10">10月</option>
                                                        <option value="11">11月</option>
                                                        <option value="12">12月</option>
                                                    </select>
                                                </div>
                                                <div class="col-4">
                                                    <label class="form-label small">第几周</label>
                                                    <select class="form-select form-select-sm" id="weekSecondWeek">
                                                        <!-- 动态生成周次选项 -->
                                                    </select>
                                                </div>
                                            </div>
                                            <div class="mt-2">
                                                <small class="text-muted" id="weekSecondRange">选择周次后显示日期</small>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- 操作按钮 -->
                            <div class="row mt-3">
                                <div class="col-12">
                                    <div class="d-flex justify-content-between align-items-center">
                                        <div class="d-flex gap-2">
                                            <button type="button" class="btn btn-outline-secondary btn-sm" id="setThisWeekBtn">
                                                <i class="fas fa-calendar-week"></i> 本周
                                            </button>
                                            <button type="button" class="btn btn-outline-secondary btn-sm" id="setLastWeekBtn">
                                                <i class="fas fa-calendar-week"></i> 上周
                                            </button>
                                            <button type="button" class="btn btn-outline-secondary btn-sm" id="setThisLastWeekBtn">
                                                <i class="fas fa-calendar-week"></i> 本周vs上周
                                            </button>
                                        </div>
                                        <button class="btn btn-primary btn-sm" id="weekQueryBtn">
                                            <i class="fas fa-search"></i> 查询
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- 月对比选择器 -->
                        <div id="monthSelection" class="time-selector" style="display: none;">
                            <div class="card">
                                <div class="card-header bg-info text-white py-2">
                                    <h6 class="mb-0">
                                        <i class="fas fa-calendar-alt"></i> 月份范围选择
                                    </h6>
                                </div>
                                <div class="card-body">
                                    <div class="row g-3 align-items-end">
                                        <div class="col-md-6">
                                            <label class="form-label small">选择月份范围</label>
                                            <div class="position-relative">
                                                <input type="text" class="form-control form-control-sm" id="monthRangeInput"
                                                       placeholder="点击选择月份范围" readonly style="cursor: pointer;" />
                                                <i class="fas fa-calendar-alt position-absolute"
                                                   style="right: 10px; top: 50%; transform: translateY(-50%); color: #6c757d;"></i>
                                            </div>
                                        </div>
                                        <div class="col-md-3">
                                            <button class="btn btn-primary btn-sm w-100" id="monthQueryBtn">
                                                <i class="fas fa-search"></i> 查询
                                            </button>
                                        </div>
                                        <div class="col-md-3">
                                            <small class="text-muted">最多12个月</small>
                                        </div>
                                    </div>
                                    <div class="mt-2">
                                        <small class="text-info" id="monthRangeDisplay">选择月份范围后显示详情</small>
                                    </div>
                                </div>
                            </div>

                            <!-- 自定义月份选择器弹出框 -->
                            <div id="monthPickerModal" class="position-absolute bg-white border rounded shadow-lg p-2"
                                 style="display: none; z-index: 1050; width: 280px;">

                                <!-- 起始月份选择 -->
                                <div class="mb-2">
                                    <h6 class="text-center mb-2 text-primary small">起始月份</h6>
                                    <div class="text-center mb-1">
                                        <button class="btn btn-sm btn-outline-secondary py-0 px-1" id="startYearPrev">&lt;</button>
                                        <span class="mx-2 fw-bold small" id="startYearDisplay">2025年</span>
                                        <button class="btn btn-sm btn-outline-secondary py-0 px-1" id="startYearNext">&gt;</button>
                                    </div>
                                    <div class="row g-1" id="startMonthGrid">
                                        <!-- 动态生成月份按钮 -->
                                    </div>
                                </div>

                                <!-- 分隔线 -->
                                <hr class="my-2">

                                <!-- 结束月份选择 -->
                                <div class="mb-2">
                                    <h6 class="text-center mb-2 text-success small">结束月份</h6>
                                    <div class="text-center mb-1">
                                        <button class="btn btn-sm btn-outline-secondary py-0 px-1" id="endYearPrev">&lt;</button>
                                        <span class="mx-2 fw-bold small" id="endYearDisplay">2025年</span>
                                        <button class="btn btn-sm btn-outline-secondary py-0 px-1" id="endYearNext">&gt;</button>
                                    </div>
                                    <div class="row g-1" id="endMonthGrid">
                                        <!-- 动态生成月份按钮 -->
                                    </div>
                                </div>

                                <div class="text-center mt-2 pt-1 border-top">
                                    <button class="btn btn-sm btn-success me-2 py-1" id="confirmMonthRange" disabled>确定</button>
                                    <button class="btn btn-sm btn-secondary py-1" id="cancelMonthRange">取消</button>
                                </div>
                            </div>
                        </div>

                        <!-- 年对比选择器 -->
                        <div id="yearSelection" class="time-selector" style="display: none;">
                            <div class="row g-2 align-items-end">
                                <div class="col-md-3">
                                    <label class="form-label small">开始年份</label>
                                    <select class="form-select form-select-sm" id="yearStartYear">
                                        <!-- 动态生成年份选项 -->
                                    </select>
                                </div>
                                <div class="col-md-3">
                                    <label class="form-label small">结束年份</label>
                                    <select class="form-select form-select-sm" id="yearEndYear">
                                        <!-- 动态生成年份选项 -->
                                    </select>
                                </div>
                                <div class="col-md-2">
                                    <button class="btn btn-primary btn-sm w-100" id="yearQueryBtn">
                                        <i class="fas fa-search"></i> 查询
                                    </button>
                                </div>
                                <div class="col-md-4">
                                    <small class="text-muted">最多选择3年数据</small>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- 查询结果显示区域 -->
                    <div id="queryResultArea" class="mt-3" style="display: none;">
                        <div class="card border-0 shadow-sm">
                            <div class="card-header bg-light">
                                <h6 class="mb-0" id="queryResultTitle">
                                    <i class="fas fa-chart-bar text-primary"></i> 查询结果
                                </h6>
                            </div>
                            <div class="card-body">
                                <div id="queryResultContent">
                                    <!-- 动态生成查询结果内容 -->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 总览卡片区 -->
    <div class="row mb-4" id="overviewCards">
        <div class="col-xl-3 col-lg-6 col-md-6 mb-3">
            <div class="card stats-card stats-card-inbound border-0 shadow-sm">
                <div class="card-body">
                    <div class="d-flex justify-content-between align-items-start">
                        <div>
                            <div class="stats-icon bg-primary bg-opacity-10 text-primary mb-3">
                                <i class="fas fa-arrow-down"></i>
                            </div>
                            <h6 class="text-muted mb-1">今日进货</h6>
                            <div class="d-flex align-items-end">
                                <h3 class="mb-0 me-2" id="todayInboundCount">-</h3>
                                <span class="text-muted">票</span>
                            </div>
                            <div class="mt-2">
                                <small class="text-muted">
                                    <span id="todayInboundPallets">-</span>板 · 
                                    <span id="todayInboundPackages">-</span>件
                                </small>
                            </div>
                        </div>
                        <div class="trend-indicator" id="inboundTrend">
                            <span class="badge bg-success">
                                <i class="fas fa-arrow-up"></i> +0%
                            </span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="col-xl-3 col-lg-6 col-md-6 mb-3">
            <div class="card stats-card stats-card-outbound border-0 shadow-sm">
                <div class="card-body">
                    <div class="d-flex justify-content-between align-items-start">
                        <div>
                            <div class="stats-icon bg-success bg-opacity-10 text-success mb-3">
                                <i class="fas fa-arrow-up"></i>
                            </div>
                            <h6 class="text-muted mb-1">今日出货</h6>
                            <div class="d-flex align-items-end">
                                <h3 class="mb-0 me-2" id="todayOutboundCount">-</h3>
                                <span class="text-muted">票</span>
                            </div>
                            <div class="mt-2">
                                <small class="text-muted">
                                    <span id="todayOutboundPallets">-</span>板 · 
                                    <span id="todayOutboundPackages">-</span>件
                                </small>
                            </div>
                        </div>
                        <div class="trend-indicator" id="outboundTrend">
                            <span class="badge bg-success">
                                <i class="fas fa-arrow-up"></i> +0%
                            </span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="col-xl-3 col-lg-6 col-md-6 mb-3">
            <div class="card stats-card stats-card-inventory border-0 shadow-sm">
                <div class="card-body">
                    <div class="d-flex justify-content-between align-items-start">
                        <div>
                            <div class="stats-icon bg-info bg-opacity-10 text-info mb-3">
                                <i class="fas fa-boxes"></i>
                            </div>
                            <h6 class="text-muted mb-1">库存总量</h6>
                            <div class="d-flex align-items-end">
                                <h3 class="mb-0 me-2" id="inventoryCount">-</h3>
                                <span class="text-muted">票</span>
                            </div>
                            <div class="mt-2">
                                <small class="text-muted">
                                    <span id="inventoryPallets">-</span>板 · 
                                    <span id="inventoryPackages">-</span>件
                                </small>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="col-xl-3 col-lg-6 col-md-6 mb-3">
            <div class="card stats-card stats-card-transit border-0 shadow-sm">
                <div class="card-body">
                    <div class="d-flex justify-content-between align-items-start">
                        <div>
                            <div class="stats-icon bg-warning bg-opacity-10 text-warning mb-3">
                                <i class="fas fa-truck"></i>
                            </div>
                            <h6 class="text-muted mb-1">在途货物</h6>
                            <div class="d-flex align-items-end">
                                <h3 class="mb-0 me-2" id="transitCount">-</h3>
                                <span class="text-muted">票</span>
                            </div>
                            <div class="mt-2">
                                <small class="text-muted">
                                    <span id="transitPallets">-</span>板 · 
                                    <span id="transitPackages">-</span>件
                                </small>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 仓库数据概览卡片区 -->
    <div class="row mb-5">
        <div class="col-12">
            <div class="card border-0 shadow-sm" style="border-radius: 16px; overflow: hidden;">
                <div class="card-header" style="background: linear-gradient(135deg, #f8f9fa, #e9ecef); border-bottom: 1px solid #dee2e6;">
                    <div class="dashboard-header mb-0">
                        <h4 class="dashboard-title mb-2">
                            <i class="fas fa-chart-line me-2"></i>
                            仓库货量数据概览
                        </h4>
                        <p class="dashboard-subtitle mb-0">实时监控各仓库货量变化趋势</p>
                    </div>
                </div>
                <div class="card-body p-4">
                    <div class="warehouse-cards-container">
                        <div class="row g-5" id="warehouseCardsGrid">
                    <!-- 平湖仓 -->
                    <div class="col-xl-3 col-lg-6 col-md-6">
                        <div class="warehouse-card pinghu-card" data-warehouse="pinghu">
                            <div class="warehouse-card-header">
                                <div class="warehouse-icon">
                                    <i class="fas fa-warehouse"></i>
                                </div>
                                <div class="warehouse-info">
                                    <h5 class="warehouse-name">平湖仓</h5>
                                    <span class="warehouse-code">PH</span>
                                    <span class="warehouse-type">前端仓库</span>
                                </div>
                                <div class="warehouse-status">
                                    <span class="status-indicator active"></span>
                                </div>
                            </div>
                            <div class="warehouse-card-body" id="warehouse-1-data">
                                <div class="loading-state">
                                    <div class="loading-spinner"></div>
                                    <span>数据加载中...</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- 昆山仓 -->
                    <div class="col-xl-3 col-lg-6 col-md-6">
                        <div class="warehouse-card kunshan-card" data-warehouse="kunshan">
                            <div class="warehouse-card-header">
                                <div class="warehouse-icon">
                                    <i class="fas fa-warehouse"></i>
                                </div>
                                <div class="warehouse-info">
                                    <h5 class="warehouse-name">昆山仓</h5>
                                    <span class="warehouse-code">KS</span>
                                    <span class="warehouse-type">前端仓库</span>
                                </div>
                                <div class="warehouse-status">
                                    <span class="status-indicator active"></span>
                                </div>
                            </div>
                            <div class="warehouse-card-body" id="warehouse-2-data">
                                <div class="loading-state">
                                    <div class="loading-spinner"></div>
                                    <span>数据加载中...</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- 成都仓 -->
                    <div class="col-xl-3 col-lg-6 col-md-6">
                        <div class="warehouse-card chengdu-card" data-warehouse="chengdu">
                            <div class="warehouse-card-header">
                                <div class="warehouse-icon">
                                    <i class="fas fa-warehouse"></i>
                                </div>
                                <div class="warehouse-info">
                                    <h5 class="warehouse-name">成都仓</h5>
                                    <span class="warehouse-code">CD</span>
                                    <span class="warehouse-type">前端仓库</span>
                                </div>
                                <div class="warehouse-status">
                                    <span class="status-indicator active"></span>
                                </div>
                            </div>
                            <div class="warehouse-card-body" id="warehouse-3-data">
                                <div class="loading-state">
                                    <div class="loading-spinner"></div>
                                    <span>数据加载中...</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- 凭祥北投仓 -->
                    <div class="col-xl-3 col-lg-6 col-md-6">
                        <div class="warehouse-card pingxiang-card" data-warehouse="pingxiang">
                            <div class="warehouse-card-header">
                                <div class="warehouse-icon">
                                    <i class="fas fa-warehouse"></i>
                                </div>
                                <div class="warehouse-info">
                                    <h5 class="warehouse-name">凭祥北投仓</h5>
                                    <span class="warehouse-code">PX</span>
                                    <span class="warehouse-type">后端仓库</span>
                                </div>
                                <div class="warehouse-status">
                                    <span class="status-indicator active"></span>
                                </div>
                            </div>
                            <div class="warehouse-card-body" id="warehouse-4-data">
                                <div class="loading-state">
                                    <div class="loading-spinner"></div>
                                    <span>数据加载中...</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>



    <!-- 数据分析图表区 -->
    <div class="row mb-5">
        <div class="col-12">
            <div class="dashboard-header mb-4">
                <h4 class="dashboard-title">
                    <i class="fas fa-analytics me-2"></i>
                    数据分析图表
                </h4>
                <p class="dashboard-subtitle">可视化数据趋势分析</p>
            </div>

            <div class="row g-4">
                <!-- 趋势对比图 -->
                <div class="col-lg-8">
                    <div class="chart-card">
                        <div class="chart-header">
                            <h5 class="chart-title">
                                <i class="fas fa-chart-line me-2"></i>
                                <span id="comparisonTitle">货量趋势对比</span>
                            </h5>
                            <div class="chart-controls">
                                <button class="btn btn-sm btn-outline-primary active" data-period="week">周对比</button>
                                <button class="btn btn-sm btn-outline-primary" data-period="month">月对比</button>
                            </div>
                        </div>
                        <div class="chart-body">
                            <div id="comparisonChart" style="height: 350px;"></div>
                        </div>
                    </div>
                </div>

                <!-- 分布饼图 -->
                <div class="col-lg-4">
                    <div class="chart-card">
                        <div class="chart-header">
                            <h5 class="chart-title">
                                <i class="fas fa-chart-pie me-2"></i>
                                仓库分布占比
                            </h5>
                        </div>
                        <div class="chart-body">
                            <div id="distributionChart" style="height: 350px;"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 增长率分析区 -->
    <div class="row mb-5">
        <div class="col-lg-6">
            <div class="chart-card">
                <div class="chart-header">
                    <h5 class="chart-title">
                        <i class="fas fa-chart-area me-2"></i>
                        增长率趋势
                    </h5>
                    <div class="chart-subtitle">各仓库货量增长率对比</div>
                </div>
                <div class="chart-body">
                    <div id="growthChart" style="height: 300px;"></div>
                </div>
            </div>
        </div>

        <div class="col-lg-6">
            <div class="chart-card">
                <div class="chart-header">
                    <h5 class="chart-title">
                        <i class="fas fa-chart-bar me-2"></i>
                        效率指标
                    </h5>
                    <div class="chart-subtitle">仓库运营效率分析</div>
                </div>
                <div class="chart-body">
                    <div id="efficiencyChart" style="height: 300px;"></div>
                </div>
            </div>
        </div>
    </div>
</div>


{% endblock %}

{% block extra_css %}
<!-- 仓库分组表格样式 - 强制刷新缓存 -->
<link rel="stylesheet" href="{{ url_for('static', filename='css/warehouse-table-grouping.css') }}?v=20250720-2">
<style>
/* 现代化仪表板样式 */
.cargo-volume-dashboard {
    background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
    min-height: 100vh;
    padding: 20px 0;
}

/* 仪表板标题区域 */
.dashboard-header {
    text-align: center;
    margin-bottom: 2rem;
}

.dashboard-title {
    color: #2c3e50;
    font-weight: 700;
    font-size: 2.2rem;
    margin-bottom: 0.5rem;
    text-shadow: 0 2px 4px rgba(0,0,0,0.1);
}

.dashboard-subtitle {
    color: #7f8c8d;
    font-size: 1.1rem;
    margin-bottom: 0;
}

/* 现代化仓库卡片 */
.warehouse-card {
    background: white;
    border-radius: 20px;
    box-shadow: 0 10px 30px rgba(0,0,0,0.1);
    transition: all 0.3s ease;
    overflow: hidden;
    position: relative;
    height: 100%;
}

.warehouse-card:hover {
    transform: translateY(-8px);
    box-shadow: 0 25px 50px rgba(0,0,0,0.2);
}

.warehouse-card::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 6px;
    background: linear-gradient(90deg, #667eea, #764ba2);
}

/* 平湖仓专属样式 - 紫色主题 */
.pinghu-card {
    border: 2px solid rgba(102, 126, 234, 0.2);
    background: linear-gradient(135deg, #f8f9ff 0%, #f0f4ff 100%);
}

.pinghu-card::before {
    background: linear-gradient(90deg, #667eea, #764ba2);
    box-shadow: 0 2px 10px rgba(102, 126, 234, 0.3);
}

.pinghu-card:hover {
    border-color: rgba(102, 126, 234, 0.4);
    box-shadow: 0 25px 50px rgba(102, 126, 234, 0.15);
}

/* 昆山仓专属样式 - 粉红色主题 */
.kunshan-card {
    border: 2px solid rgba(240, 147, 251, 0.2);
    background: linear-gradient(135deg, #fff8fd 0%, #fef0ff 100%);
}

.kunshan-card::before {
    background: linear-gradient(90deg, #f093fb, #f5576c);
    box-shadow: 0 2px 10px rgba(240, 147, 251, 0.3);
}

.kunshan-card:hover {
    border-color: rgba(240, 147, 251, 0.4);
    box-shadow: 0 25px 50px rgba(240, 147, 251, 0.15);
}

/* 成都仓专属样式 - 蓝色主题 */
.chengdu-card {
    border: 2px solid rgba(79, 172, 254, 0.2);
    background: linear-gradient(135deg, #f0fbff 0%, #e6f7ff 100%);
}

.chengdu-card::before {
    background: linear-gradient(90deg, #4facfe, #00f2fe);
    box-shadow: 0 2px 10px rgba(79, 172, 254, 0.3);
}

.chengdu-card:hover {
    border-color: rgba(79, 172, 254, 0.4);
    box-shadow: 0 25px 50px rgba(79, 172, 254, 0.15);
}

/* 凭祥北投仓专属样式 - 绿色主题 */
.pingxiang-card {
    border: 2px solid rgba(67, 233, 123, 0.2);
    background: linear-gradient(135deg, #f0fff4 0%, #e6ffed 100%);
}

.pingxiang-card::before {
    background: linear-gradient(90deg, #43e97b, #38f9d7);
    box-shadow: 0 2px 10px rgba(67, 233, 123, 0.3);
}

.pingxiang-card:hover {
    border-color: rgba(67, 233, 123, 0.4);
    box-shadow: 0 25px 50px rgba(67, 233, 123, 0.15);
}

.warehouse-card-header {
    padding: 1.5rem;
    display: flex;
    align-items: center;
    justify-content: space-between;
}

.warehouse-icon {
    width: 60px;
    height: 60px;
    border-radius: 15px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.8rem;
    color: white;
    background: linear-gradient(135deg, #667eea, #764ba2);
    box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
}

.pinghu-card .warehouse-icon {
    background: linear-gradient(135deg, #667eea, #764ba2);
    box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
}

.kunshan-card .warehouse-icon {
    background: linear-gradient(135deg, #f093fb, #f5576c);
    box-shadow: 0 4px 15px rgba(240, 147, 251, 0.4);
}

.chengdu-card .warehouse-icon {
    background: linear-gradient(135deg, #4facfe, #00f2fe);
    box-shadow: 0 4px 15px rgba(79, 172, 254, 0.4);
}

.pingxiang-card .warehouse-icon {
    background: linear-gradient(135deg, #43e97b, #38f9d7);
    box-shadow: 0 4px 15px rgba(67, 233, 123, 0.4);
}

.warehouse-info {
    flex: 1;
    margin-left: 1rem;
}

.warehouse-name {
    font-size: 1.3rem;
    font-weight: 700;
    color: #2c3e50;
    margin-bottom: 0.3rem;
}

.warehouse-code {
    background: #ecf0f1;
    color: #7f8c8d;
    padding: 0.2rem 0.6rem;
    border-radius: 12px;
    font-size: 0.8rem;
    font-weight: 600;
    margin-right: 0.5rem;
}

.warehouse-type {
    color: #95a5a6;
    font-size: 0.9rem;
}

.warehouse-status {
    display: flex;
    align-items: center;
}

.status-indicator {
    width: 12px;
    height: 12px;
    border-radius: 50%;
    background: #2ecc71;
    box-shadow: 0 0 0 3px rgba(46, 204, 113, 0.3);
    animation: pulse 2s infinite;
}

@keyframes pulse {
    0% { box-shadow: 0 0 0 0 rgba(46, 204, 113, 0.7); }
    70% { box-shadow: 0 0 0 10px rgba(46, 204, 113, 0); }
    100% { box-shadow: 0 0 0 0 rgba(46, 204, 113, 0); }
}

.warehouse-card-body {
    padding: 0 1.5rem 1.5rem;
}

/* 数据统计项 */
.stat-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 1rem;
    margin-bottom: 0.5rem;
    border-radius: 12px;
    background: rgba(255, 255, 255, 0.7);
    border: 1px solid rgba(0, 0, 0, 0.05);
    transition: all 0.3s ease;
}

.stat-item:hover {
    transform: translateX(5px);
    background: rgba(255, 255, 255, 0.9);
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
}

.stat-item:last-child {
    margin-bottom: 0;
}

.stat-label {
    color: #5a6c7d;
    font-size: 0.9rem;
    font-weight: 500;
}

.stat-value {
    font-weight: 700;
    font-size: 1.2rem;
    color: #2c3e50;
}

.stat-trend {
    font-size: 0.8rem;
    margin-left: 0.5rem;
    padding: 0.2rem 0.5rem;
    border-radius: 12px;
    font-weight: 600;
}

.trend-up {
    color: #27ae60;
    background: rgba(39, 174, 96, 0.1);
}

.trend-down {
    color: #e74c3c;
    background: rgba(231, 76, 60, 0.1);
}

/* 各仓库数据项主题色 */
.pinghu-card .stat-item {
    background: linear-gradient(135deg, rgba(102, 126, 234, 0.05), rgba(118, 75, 162, 0.05));
    border-color: rgba(102, 126, 234, 0.1);
}

.pinghu-card .stat-item:hover {
    background: linear-gradient(135deg, rgba(102, 126, 234, 0.1), rgba(118, 75, 162, 0.1));
    border-color: rgba(102, 126, 234, 0.2);
}

.kunshan-card .stat-item {
    background: linear-gradient(135deg, rgba(240, 147, 251, 0.05), rgba(245, 87, 108, 0.05));
    border-color: rgba(240, 147, 251, 0.1);
}

.kunshan-card .stat-item:hover {
    background: linear-gradient(135deg, rgba(240, 147, 251, 0.1), rgba(245, 87, 108, 0.1));
    border-color: rgba(240, 147, 251, 0.2);
}

.chengdu-card .stat-item {
    background: linear-gradient(135deg, rgba(79, 172, 254, 0.05), rgba(0, 242, 254, 0.05));
    border-color: rgba(79, 172, 254, 0.1);
}

.chengdu-card .stat-item:hover {
    background: linear-gradient(135deg, rgba(79, 172, 254, 0.1), rgba(0, 242, 254, 0.1));
    border-color: rgba(79, 172, 254, 0.2);
}

.pingxiang-card .stat-item {
    background: linear-gradient(135deg, rgba(67, 233, 123, 0.05), rgba(56, 249, 215, 0.05));
    border-color: rgba(67, 233, 123, 0.1);
}

.pingxiang-card .stat-item:hover {
    background: linear-gradient(135deg, rgba(67, 233, 123, 0.1), rgba(56, 249, 215, 0.1));
    border-color: rgba(67, 233, 123, 0.2);
}

/* 加载状态 */
.loading-state {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    padding: 2rem;
    color: #95a5a6;
}

.loading-spinner {
    width: 40px;
    height: 40px;
    border: 3px solid #ecf0f1;
    border-top: 3px solid #3498db;
    border-radius: 50%;
    animation: spin 1s linear infinite;
    margin-bottom: 1rem;
}

@keyframes spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
}

/* 汇总卡片 */
.summary-card {
    background: white;
    border-radius: 16px;
    box-shadow: 0 8px 25px rgba(0,0,0,0.1);
    transition: all 0.3s ease;
    overflow: hidden;
    height: 100%;
}

.summary-card:hover {
    transform: translateY(-3px);
    box-shadow: 0 15px 35px rgba(0,0,0,0.15);
}

.summary-header {
    padding: 1.5rem;
    display: flex;
    align-items: center;
    background: linear-gradient(135deg, #f8f9fa, #e9ecef);
}

.summary-icon {
    width: 50px;
    height: 50px;
    border-radius: 12px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.5rem;
    color: white;
    background: linear-gradient(135deg, #6c757d, #495057);
    margin-right: 1rem;
}

.total-summary .summary-icon {
    background: linear-gradient(135deg, #007bff, #0056b3);
}

.frontend-summary .summary-icon {
    background: linear-gradient(135deg, #28a745, #1e7e34);
}

.backend-summary .summary-icon {
    background: linear-gradient(135deg, #ffc107, #e0a800);
}

.summary-info h5 {
    font-size: 1.2rem;
    font-weight: 700;
    color: #2c3e50;
    margin-bottom: 0.2rem;
}

.summary-subtitle {
    color: #6c757d;
    font-size: 0.9rem;
}

.summary-body {
    padding: 1.5rem;
}

/* 图表卡片 */
.chart-card {
    background: white;
    border-radius: 16px;
    box-shadow: 0 8px 25px rgba(0,0,0,0.1);
    overflow: hidden;
    height: 100%;
}

.chart-header {
    padding: 1.5rem;
    background: linear-gradient(135deg, #f8f9fa, #e9ecef);
    display: flex;
    justify-content: space-between;
    align-items: center;
    border-bottom: 1px solid #dee2e6;
}

.chart-title {
    font-size: 1.2rem;
    font-weight: 700;
    color: #2c3e50;
    margin: 0;
}

.chart-subtitle {
    color: #6c757d;
    font-size: 0.9rem;
    margin-top: 0.3rem;
}

.chart-controls {
    display: flex;
    gap: 0.5rem;
}

.chart-controls .btn {
    border-radius: 20px;
    padding: 0.4rem 1rem;
    font-size: 0.85rem;
}

.chart-body {
    padding: 1.5rem;
}

/* 响应式设计 */
@media (max-width: 768px) {
    .dashboard-title {
        font-size: 1.8rem;
    }

    .warehouse-card-header {
        flex-direction: column;
        text-align: center;
    }

    .warehouse-info {
        margin-left: 0;
        margin-top: 1rem;
    }

    .chart-header {
        flex-direction: column;
        gap: 1rem;
    }
}

.cargo-volume-dashboard .text-danger {
    color: #dc3545 !important;
}
.stats-card {
    transition: transform 0.2s ease-in-out;
    background: linear-gradient(135deg, #fafbfc 0%, #f0f2f5 100%) !important;
}

.stats-card:hover {
    transform: translateY(-2px);
}

/* 为每个卡片设置不同的浅色背景 */
.stats-card-inbound {
    background: linear-gradient(135deg, #f0f8ff 0%, #e6f3ff 100%) !important;
}

.stats-card-outbound {
    background: linear-gradient(135deg, #f0fff4 0%, #e6ffe6 100%) !important;
}

.stats-card-inventory {
    background: linear-gradient(135deg, #f0ffff 0%, #e6ffff 100%) !important;
}

.stats-card-transit {
    background: linear-gradient(135deg, #fffaf0 0%, #fff5e6 100%) !important;
}

.stats-icon {
    width: 48px;
    height: 48px;
    border-radius: 12px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 20px;
}

.trend-indicator .badge {
    font-size: 0.75rem;
}

.card-header {
    padding: 1rem 1.5rem 0.5rem;
}

.warehouse-stat-item {
    padding: 1rem;
}

/* 仓库卡片样式 */
.warehouse-stats .stat-section {
    border-bottom: 1px solid #e9ecef;
    padding-bottom: 12px;
    margin-bottom: 12px;
}

.warehouse-stats .stat-section:last-child {
    border-bottom: none;
    padding-bottom: 0;
    margin-bottom: 0;
}

.warehouse-stats .stat-item {
    text-align: center;
    padding: 8px 4px;
}

.warehouse-stats .stat-label {
    font-size: 0.75rem;
    color: #6c757d;
    margin-bottom: 2px;
}

.warehouse-stats .stat-value {
    font-size: 1.1rem;
    font-weight: 600;
    margin-bottom: 1px;
}

.warehouse-stats .stat-unit {
    font-size: 0.7rem;
    color: #6c757d;
}

.warehouse-stats .comparison-item {
    padding: 6px 0;
    border-bottom: 1px solid #f8f9fa;
}

.warehouse-stats .comparison-item:last-child {
    border-bottom: none;
}

.warehouse-stats .comparison-bars .progress {
    border-radius: 4px;
}

.summary-stats .stat-section {
    border-bottom: 1px solid #e9ecef;
    padding-bottom: 12px;
    margin-bottom: 12px;
}

.summary-stats .stat-section:last-child {
    border-bottom: none;
    padding-bottom: 0;
    margin-bottom: 0;
}

.summary-stats .stat-item {
    text-align: center;
    padding: 8px 4px;
}

.summary-stats .stat-value {
    font-size: 1.2rem;
    font-weight: 600;
    margin-bottom: 1px;
}

.summary-stats .stat-unit {
    font-size: 0.75rem;
    color: #6c757d;
}

.loading-placeholder {
    padding: 40px 20px;
    color: #6c757d;
}

/* 时间选择器样式 */
.time-selector {
    background: #f8f9fa;
    border-radius: 8px;
    padding: 15px;
    border: 1px solid #e9ecef;
}

.time-selector .form-label {
    font-weight: 500;
    color: #495057;
    margin-bottom: 4px;
}

.time-selector .form-control-sm,
.time-selector .form-select-sm {
    border-radius: 6px;
    border: 1px solid #ced4da;
}

.time-selector .form-control-sm:focus,
.time-selector .form-select-sm:focus {
    border-color: #007bff;
    box-shadow: 0 0 0 0.2rem rgba(0, 123, 255, 0.25);
}

#queryResultArea {
    animation: fadeIn 0.3s ease-in-out;
}

@keyframes fadeIn {
    from { opacity: 0; transform: translateY(-10px); }
    to { opacity: 1; transform: translateY(0); }
}

/* 查询结果表格样式 - 仓库分组优化 */
.query-result-table {
    font-size: 0.85rem !important;
    border: 2px solid #333 !important;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1) !important;
    border-radius: 8px !important;
    overflow: hidden !important;
    border-collapse: separate !important;
}

.query-result-table th {
    background-color: #f8f9fa !important;
    color: #333 !important;
    border: 1px solid #dee2e6 !important;
    font-weight: 600 !important;
    white-space: nowrap !important;
    padding: 8px 6px !important;
    text-align: center !important;
    position: relative !important;
}

.query-result-table td {
    color: #333 !important;
    padding: 6px 4px !important;
    vertical-align: middle !important;
    white-space: nowrap !important;
    border: 1px solid #dee2e6 !important;
    text-align: center !important;
    position: relative !important;
}

.query-result-table .small {
    font-size: 0.75rem !important;
}

/* 仓库分组边框样式 - 更明显的视觉分组 */

/* 平湖仓分组 - 深蓝渐变边框块 - 强化效果 */
.query-result-table th:nth-child(2),
.query-result-table th:nth-child(3),
.query-result-table th:nth-child(4),
.query-result-table td:nth-child(2),
.query-result-table td:nth-child(3),
.query-result-table td:nth-child(4) {
    background-color: rgba(30, 60, 114, 0.08) !important;
    border-top: 3px solid #1e3c72 !important;
    border-bottom: 3px solid #1e3c72 !important;
    border-left: 2px solid #1e3c72 !important;
    border-right: 2px solid #1e3c72 !important;
    position: relative !important;
}

.query-result-table th:nth-child(2),
.query-result-table td:nth-child(2) {
    border-left: 6px solid #007bff !important;
    box-shadow: -4px 0 8px rgba(0, 123, 255, 0.4) !important;
}

.query-result-table th:nth-child(4),
.query-result-table td:nth-child(4) {
    border-right: 6px solid #007bff !important;
    box-shadow: 4px 0 8px rgba(0, 123, 255, 0.4) !important;
}

/* 昆山仓分组 - 绿色边框块 - 强化效果 */
.query-result-table th:nth-child(5),
.query-result-table th:nth-child(6),
.query-result-table th:nth-child(7),
.query-result-table td:nth-child(5),
.query-result-table td:nth-child(6),
.query-result-table td:nth-child(7) {
    background-color: rgba(40, 167, 69, 0.15) !important;
    border-top: 4px solid #28a745 !important;
    border-bottom: 4px solid #28a745 !important;
    border-left: 3px solid #28a745 !important;
    border-right: 3px solid #28a745 !important;
    position: relative !important;
}

.query-result-table th:nth-child(5),
.query-result-table td:nth-child(5) {
    border-left: 6px solid #28a745 !important;
    box-shadow: -4px 0 8px rgba(40, 167, 69, 0.4) !important;
}

.query-result-table th:nth-child(7),
.query-result-table td:nth-child(7) {
    border-right: 6px solid #28a745 !important;
    box-shadow: 4px 0 8px rgba(40, 167, 69, 0.4) !important;
}

/* 成都仓分组 - 橙色边框块 - 强化效果 */
.query-result-table th:nth-child(8),
.query-result-table th:nth-child(9),
.query-result-table th:nth-child(10),
.query-result-table td:nth-child(8),
.query-result-table td:nth-child(9),
.query-result-table td:nth-child(10) {
    background-color: rgba(253, 126, 20, 0.15) !important;
    border-top: 4px solid #fd7e14 !important;
    border-bottom: 4px solid #fd7e14 !important;
    border-left: 3px solid #fd7e14 !important;
    border-right: 3px solid #fd7e14 !important;
    position: relative !important;
}

.query-result-table th:nth-child(8),
.query-result-table td:nth-child(8) {
    border-left: 6px solid #fd7e14 !important;
    box-shadow: -4px 0 8px rgba(253, 126, 20, 0.4) !important;
}

.query-result-table th:nth-child(10),
.query-result-table td:nth-child(10) {
    border-right: 6px solid #fd7e14 !important;
    box-shadow: 4px 0 8px rgba(253, 126, 20, 0.4) !important;
}

/* 凭祥北投仓分组 - 紫色边框块 - 强化效果 */
.query-result-table th:nth-child(11),
.query-result-table th:nth-child(12),
.query-result-table th:nth-child(13),
.query-result-table td:nth-child(11),
.query-result-table td:nth-child(12),
.query-result-table td:nth-child(13) {
    background-color: rgba(111, 66, 193, 0.15) !important;
    border-top: 4px solid #6f42c1 !important;
    border-bottom: 4px solid #6f42c1 !important;
    border-left: 3px solid #6f42c1 !important;
    border-right: 3px solid #6f42c1 !important;
    position: relative !important;
}

.query-result-table th:nth-child(11),
.query-result-table td:nth-child(11) {
    border-left: 6px solid #6f42c1 !important;
    box-shadow: -4px 0 8px rgba(111, 66, 193, 0.4) !important;
}

.query-result-table th:nth-child(13),
.query-result-table td:nth-child(13) {
    border-right: 6px solid #6f42c1 !important;
    box-shadow: 4px 0 8px rgba(111, 66, 193, 0.4) !important;
}

/* 合计分组 - 红色边框块 - 强化效果 */
.query-result-table th:nth-child(14),
.query-result-table th:nth-child(15),
.query-result-table th:nth-child(16),
.query-result-table td:nth-child(14),
.query-result-table td:nth-child(15),
.query-result-table td:nth-child(16) {
    background-color: rgba(220, 53, 69, 0.15) !important;
    border-top: 4px solid #dc3545 !important;
    border-bottom: 4px solid #dc3545 !important;
    border-left: 3px solid #dc3545 !important;
    border-right: 3px solid #dc3545 !important;
    font-weight: 600 !important;
    position: relative !important;
}

.query-result-table th:nth-child(14),
.query-result-table td:nth-child(14) {
    border-left: 6px solid #dc3545 !important;
    box-shadow: -4px 0 8px rgba(220, 53, 69, 0.4) !important;
}

.query-result-table th:nth-child(16),
.query-result-table td:nth-child(16) {
    border-right: 6px solid #dc3545 !important;
    box-shadow: 4px 0 8px rgba(220, 53, 69, 0.4) !important;
}

/* 表格头部分组样式 - 仓库标题突出显示 */
.query-result-table thead tr:first-child th {
    background-color: #e9ecef !important;
    color: #333 !important;
    font-weight: 700 !important;
    border-bottom: 2px solid #333 !important;
    font-size: 0.9rem !important;
    padding: 10px 6px !important;
}

/* 仓库名称标题背景颜色 - 简洁明亮风格 */
/* 平湖仓 - 第2列 (colspan=3) - 浅蓝色 */
.query-result-table thead tr:first-child th:nth-child(2) {
    background-color: #e3f2fd !important;
    color: #000000 !important;
    border: 3px solid #1976d2 !important;
    font-weight: bold !important;
    text-shadow: none !important;
    box-shadow: 0 2px 4px rgba(25, 118, 210, 0.2) !important;
}

/* 昆山仓 - 第3列 (colspan=3) - 浅绿色 */
.query-result-table thead tr:first-child th:nth-child(3) {
    background-color: #e8f5e8 !important;
    color: #000000 !important;
    border: 3px solid #388e3c !important;
    font-weight: bold !important;
    text-shadow: none !important;
    box-shadow: 0 2px 4px rgba(56, 142, 60, 0.2) !important;
}

/* 成都仓 - 第4列 (colspan=3) - 浅橙色 */
.query-result-table thead tr:first-child th:nth-child(4) {
    background-color: #fff3e0 !important;
    color: #000000 !important;
    border: 3px solid #f57c00 !important;
    font-weight: bold !important;
    text-shadow: none !important;
    box-shadow: 0 2px 4px rgba(245, 124, 0, 0.2) !important;
}

/* 凭祥北投仓 - 第5列 (colspan=3) - 浅紫色 */
.query-result-table thead tr:first-child th:nth-child(5) {
    background-color: #f3e5f5 !important;
    color: #000000 !important;
    border: 3px solid #7b1fa2 !important;
    font-weight: bold !important;
    text-shadow: none !important;
    box-shadow: 0 2px 4px rgba(123, 31, 162, 0.2) !important;
}

/* 合计 - 第6列 (colspan=3) - 浅红色 */
.query-result-table thead tr:first-child th:nth-child(6) {
    background-color: #ffebee !important;
    color: #000000 !important;
    border: 3px solid #d32f2f !important;
    font-weight: bold !important;
    text-shadow: none !important;
    box-shadow: 0 2px 4px rgba(211, 47, 47, 0.2) !important;
}

.query-result-table thead tr:last-child th {
    background-color: #f8f9fa !important;
    color: #333 !important;
    border-bottom: 2px solid #dee2e6 !important;
    font-weight: 600 !important;
}

/* 仓库标题CSS类样式 - 简洁明亮风格 */
.warehouse-header-ph {
    background-color: #e3f2fd !important;
    color: #000000 !important;
    border: 3px solid #1976d2 !important;
    font-weight: bold !important;
    text-shadow: none !important;
    box-shadow: 0 2px 4px rgba(25, 118, 210, 0.2) !important;
}

.warehouse-header-ks {
    background-color: #e8f5e8 !important;
    color: #000000 !important;
    border: 3px solid #388e3c !important;
    font-weight: bold !important;
    text-shadow: none !important;
    box-shadow: 0 2px 4px rgba(56, 142, 60, 0.2) !important;
}

.warehouse-header-cd {
    background-color: #fff3e0 !important;
    color: #000000 !important;
    border: 3px solid #f57c00 !important;
    font-weight: bold !important;
    text-shadow: none !important;
    box-shadow: 0 2px 4px rgba(245, 124, 0, 0.2) !important;
}

.warehouse-header-px {
    background-color: #f3e5f5 !important;
    color: #000000 !important;
    border: 3px solid #7b1fa2 !important;
    font-weight: bold !important;
    text-shadow: none !important;
    box-shadow: 0 2px 4px rgba(123, 31, 162, 0.2) !important;
}

.warehouse-header-total {
    background-color: #ffebee !important;
    color: #000000 !important;
    border: 3px solid #d32f2f !important;
    font-weight: bold !important;
    text-shadow: none !important;
    box-shadow: 0 2px 4px rgba(211, 47, 47, 0.2) !important;
}

/* 表格行样式 */
.query-result-table tbody tr:nth-child(even) {
    background-color: #f8f9fa;
}

.query-result-table tbody tr:nth-child(odd) {
    background-color: #ffffff;
}

.query-result-table tbody tr:hover {
    background-color: #e3f2fd;
}

/* 汇总行样式 */
.query-result-table .table-primary td {
    background-color: #cce5ff !important;
    font-weight: 600;
    border-top: 2px solid #007bff;
}

.query-result-table .table-info td {
    background-color: #d1ecf1 !important;
    font-weight: 600;
    border-top: 2px solid #17a2b8;
}

.query-result-table .table-success td {
    background-color: #d4edda !important;
    font-weight: 600;
    border-top: 2px solid #28a745;
}

/* 日期列特殊样式 */
.query-result-table th:first-child,
.query-result-table td:first-child {
    background-color: #f1f3f4 !important;
    font-weight: 600 !important;
    border-right: 3px solid #333 !important;
    border-left: 3px solid #333 !important;
    position: sticky !important;
    left: 0 !important;
    z-index: 10 !important;
}

/* 仓库分组间隔线 */
.query-result-table th:nth-child(4),
.query-result-table th:nth-child(7),
.query-result-table th:nth-child(10),
.query-result-table th:nth-child(13),
.query-result-table td:nth-child(4),
.query-result-table td:nth-child(7),
.query-result-table td:nth-child(10),
.query-result-table td:nth-child(13) {
    border-right: 3px solid #333 !important;
}

/* 仓库分组标识 - 添加小图标 */
.query-result-table thead tr:first-child th:nth-child(2)::before {
    content: "🏭 ";
    font-size: 0.8rem;
}

.query-result-table thead tr:first-child th:nth-child(3)::before {
    content: "🏭 ";
    font-size: 0.8rem;
}

.query-result-table thead tr:first-child th:nth-child(4)::before {
    content: "🏭 ";
    font-size: 0.8rem;
}

.query-result-table thead tr:first-child th:nth-child(5)::before {
    content: "🏭 ";
    font-size: 0.8rem;
}

.query-result-table thead tr:first-child th:nth-child(6)::before {
    content: "📊 ";
    font-size: 0.8rem;
}

/* 表格容器样式 */
.table-responsive {
    border-radius: 8px;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
    margin-bottom: 20px;
    border: 2px solid #e9ecef;
}

/* 移除测试标识，提升加载速度 */

/* 强制应用仓库标题背景颜色 */
.query-result-table th[colspan="3"] {
    padding: 12px 8px !important;
    font-size: 14px !important;
    font-weight: bold !important;
}

/* 确保所有表格都应用样式 */
table.query-result-table thead tr:first-child th {
    font-size: 13px !important;
    padding: 10px 6px !important;
}

/* 简化的仓库标题样式 - 提升性能 */

/* 仓库分组间距 - 让每个仓库数据块更独立 */
.query-result-table th:nth-child(5),
.query-result-table th:nth-child(8),
.query-result-table th:nth-child(11),
.query-result-table th:nth-child(14),
.query-result-table td:nth-child(5),
.query-result-table td:nth-child(8),
.query-result-table td:nth-child(11),
.query-result-table td:nth-child(14) {
    position: relative;
}

.query-result-table th:nth-child(5)::before,
.query-result-table th:nth-child(8)::before,
.query-result-table th:nth-child(11)::before,
.query-result-table th:nth-child(14)::before,
.query-result-table td:nth-child(5)::before,
.query-result-table td:nth-child(8)::before,
.query-result-table td:nth-child(11)::before,
.query-result-table td:nth-child(14)::before {
    content: '';
    position: absolute;
    left: -6px;
    top: 0;
    bottom: 0;
    width: 6px;
    background: #fff;
    z-index: 1;
}

/* 仓库分组悬停效果 */
.query-result-table tbody tr:hover td:nth-child(2),
.query-result-table tbody tr:hover td:nth-child(3),
.query-result-table tbody tr:hover td:nth-child(4) {
    background-color: rgba(0, 123, 255, 0.15) !important;
}

.query-result-table tbody tr:hover td:nth-child(5),
.query-result-table tbody tr:hover td:nth-child(6),
.query-result-table tbody tr:hover td:nth-child(7) {
    background-color: rgba(40, 167, 69, 0.15) !important;
}

.query-result-table tbody tr:hover td:nth-child(8),
.query-result-table tbody tr:hover td:nth-child(9),
.query-result-table tbody tr:hover td:nth-child(10) {
    background-color: rgba(253, 126, 20, 0.15) !important;
}

.query-result-table tbody tr:hover td:nth-child(11),
.query-result-table tbody tr:hover td:nth-child(12),
.query-result-table tbody tr:hover td:nth-child(13) {
    background-color: rgba(111, 66, 193, 0.15) !important;
}

.query-result-table tbody tr:hover td:nth-child(14),
.query-result-table tbody tr:hover td:nth-child(15),
.query-result-table tbody tr:hover td:nth-child(16) {
    background-color: rgba(220, 53, 69, 0.15) !important;
}

/* 仓库分组标题工具提示 */
.query-result-table thead th[title] {
    cursor: help;
}

/* 表格响应式优化 */
@media (max-width: 1200px) {
    .query-result-table {
        font-size: 0.75rem;
    }

    .query-result-table th,
    .query-result-table td {
        padding: 4px 2px;
    }
}

@media (max-width: 768px) {
    .query-result-table {
        font-size: 0.7rem;
    }

    .query-result-table th,
    .query-result-table td {
        padding: 3px 1px;
    }
}

/* 汇总卡片样式 */
.query-result-summary .summary-item {
    text-align: center;
    padding: 15px;
    background: #f8f9fa;
    border-radius: 8px;
    border: 1px solid #e9ecef;
}

.query-result-summary .summary-value {
    font-size: 1.5rem;
    font-weight: 700;
    color: #495057;
    margin-bottom: 5px;
}

.query-result-summary .summary-label {
    font-size: 0.85rem;
    color: #6c757d;
    font-weight: 500;
}

.query-result-table {
    font-size: 0.9rem;
}

.query-result-table th {
    background-color: #f8f9fa;
    font-weight: 600;
    border-top: none;
}

.query-result-summary {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    border-radius: 8px;
    padding: 20px;
    margin-bottom: 20px;
}

.summary-item {
    text-align: center;
}

.summary-item .summary-value {
    font-size: 1.5rem;
    font-weight: 700;
    margin-bottom: 5px;
}

.summary-item .summary-label {
    font-size: 0.85rem;
    opacity: 0.9;
}
    border-radius: 8px;
    background: #f8f9fa;
    margin-bottom: 0.5rem;
    transition: background-color 0.2s ease;
}

.warehouse-stat-item:hover {
    background: #e9ecef;
}

.warehouse-type-badge {
    font-size: 0.7rem;
    padding: 0.25rem 0.5rem;
}

.period-btn {
    min-height: 60px;
    padding: 0.5rem 1rem;
    line-height: 1.2;
    text-align: center;
    white-space: nowrap;
}

.period-btn small {
    font-size: 0.7rem;
    display: block;
    margin-top: 2px;
}

.period-btn:hover small {
    color: #fff !important;
}

.btn-check:checked + .period-btn small {
    color: #fff !important;
}
</style>
{% endblock %}

{% block extra_js %}
<!-- ECharts -->
<script src="https://cdn.jsdelivr.net/npm/echarts@5.4.3/dist/echarts.min.js"></script>
<script src="{{ url_for('static', filename='js/cargo_volume_dashboard.js') }}"></script>
<script>
// 优化的仓库标题背景颜色应用
let stylesApplied = false;
let observer = null;

// 初始化现代化仓库卡片
function initializeWarehouseCards() {
    // 为新的卡片结构添加交互效果
    const warehouseCards = document.querySelectorAll('.warehouse-card');
    warehouseCards.forEach(function(card) {
        // 添加点击效果
        card.addEventListener('click', function() {
            // 可以添加点击后的操作，比如显示详细信息
            console.log('点击了仓库卡片:', card.dataset.warehouse);
        });
    });

    // 确保状态指示器正常显示
    const statusIndicators = document.querySelectorAll('.status-indicator');
    statusIndicators.forEach(function(indicator) {
        indicator.classList.add('active');
    });
}

// 渲染仓库数据到新的卡片结构
function renderWarehouseDataToCard(warehouseId, data) {
    const cardBody = document.getElementById(`warehouse-${warehouseId}-data`);
    if (!cardBody) return;

    // 创建数据统计项
    const statsHtml = `
        <div class="stat-item">
            <span class="stat-label">今日入库</span>
            <div>
                <span class="stat-value">${data.inbound_today || 0}</span>
                <span class="stat-trend trend-up">
                    <i class="fas fa-arrow-up"></i> +${data.inbound_growth || 0}%
                </span>
            </div>
        </div>
        <div class="stat-item">
            <span class="stat-label">今日出库</span>
            <div>
                <span class="stat-value">${data.outbound_today || 0}</span>
                <span class="stat-trend trend-up">
                    <i class="fas fa-arrow-up"></i> +${data.outbound_growth || 0}%
                </span>
            </div>
        </div>
        <div class="stat-item">
            <span class="stat-label">库存总量</span>
            <div>
                <span class="stat-value">${data.inventory_total || 0}</span>
                <span class="stat-trend ${data.inventory_trend === 'up' ? 'trend-up' : 'trend-down'}">
                    <i class="fas fa-arrow-${data.inventory_trend === 'up' ? 'up' : 'down'}"></i>
                    ${data.inventory_change || 0}%
                </span>
            </div>
        </div>
        <div class="stat-item">
            <span class="stat-label">在途货物</span>
            <div>
                <span class="stat-value">${data.transit_total || 0}</span>
            </div>
        </div>
    `;

    cardBody.innerHTML = statsHtml;
}

// 渲染汇总数据
function renderSummaryData(type, data) {
    const summaryBody = document.getElementById(`${type}-summary-data`);
    if (!summaryBody) return;

    const summaryHtml = `
        <div class="stat-item">
            <span class="stat-label">总入库量</span>
            <span class="stat-value">${data.total_inbound || 0}</span>
        </div>
        <div class="stat-item">
            <span class="stat-label">总出库量</span>
            <span class="stat-value">${data.total_outbound || 0}</span>
        </div>
        <div class="stat-item">
            <span class="stat-label">库存总量</span>
            <span class="stat-value">${data.total_inventory || 0}</span>
        </div>
        <div class="stat-item">
            <span class="stat-label">效率指标</span>
            <div>
                <span class="stat-value">${data.efficiency || 0}%</span>
                <span class="stat-trend trend-up">
                    <i class="fas fa-arrow-up"></i> 优秀
                </span>
            </div>
        </div>
    `;

    summaryBody.innerHTML = summaryHtml;
}

document.addEventListener('DOMContentLoaded', function() {
    // 初始化货量数据看板
    const dashboard = new CargoVolumeDashboard();

    // 初始化现代化仓库卡片
    initializeWarehouseCards();

    // 立即应用一次
    applyWarehouseHeaderColors();

    // 使用MutationObserver监听DOM变化，只在表格更新时应用样式
    observer = new MutationObserver(function(mutations) {
        let shouldApply = false;
        mutations.forEach(function(mutation) {
            if (mutation.type === 'childList' &&
                (mutation.target.classList.contains('query-result-table') ||
                 mutation.target.querySelector('.query-result-table'))) {
                shouldApply = true;
            }
        });

        if (shouldApply) {
            setTimeout(function() {
                applyWarehouseHeaderColors();
                initializeWarehouseCards();
            }, 100);
        }
    });

    // 监听整个文档的变化
    observer.observe(document.body, {
        childList: true,
        subtree: true
    });
});

function applyWarehouseHeaderColors() {
    const tables = document.querySelectorAll('.query-result-table');
    if (tables.length === 0) return;

    let applied = 0;
    tables.forEach(table => {
        const headers = table.querySelectorAll('thead tr:first-child th');
        headers.forEach(th => {
            // 跳过已经应用过样式的元素
            if (th.dataset.colorApplied) return;

            const text = th.textContent.trim();
            if (text.includes('平湖仓')) {
                th.style.backgroundColor = '#007bff';
                th.style.color = 'black';
                th.style.border = '3px solid #0056b3';
                th.style.fontWeight = 'bold';
                th.dataset.colorApplied = 'true';
                applied++;
            } else if (text.includes('昆山仓')) {
                th.style.backgroundColor = '#28a745';
                th.style.color = 'black';
                th.style.border = '3px solid #1e7e34';
                th.style.fontWeight = 'bold';
                th.dataset.colorApplied = 'true';
                applied++;
            } else if (text.includes('成都仓')) {
                th.style.backgroundColor = '#fd7e14';
                th.style.color = 'black';
                th.style.border = '3px solid #e55a00';
                th.style.fontWeight = 'bold';
                th.dataset.colorApplied = 'true';
                applied++;
            } else if (text.includes('凭祥北投仓')) {
                th.style.backgroundColor = '#6f42c1';
                th.style.color = 'black';
                th.style.border = '3px solid #5a2d91';
                th.style.fontWeight = 'bold';
                th.dataset.colorApplied = 'true';
                applied++;
            } else if (text.includes('合计')) {
                th.style.backgroundColor = '#dc3545';
                th.style.color = 'black';
                th.style.border = '3px solid #c82333';
                th.style.fontWeight = 'bold';
                th.dataset.colorApplied = 'true';
                applied++;
            }
        });
    });

    if (applied > 0) {
        console.log(`✅ 应用了 ${applied} 个仓库标题背景颜色`);
    }
}
</script>
{% endblock %}
