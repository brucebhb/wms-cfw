{% extends "base.html" %}

{% block title %}æ¨¡æ€æ¡†æµ‹è¯•é¡µé¢{% endblock %}

{% block content %}
<div class="container mt-4">
    <div class="row">
        <div class="col-12">
            <h2>æ¨¡æ€æ¡†åŠŸèƒ½æµ‹è¯•</h2>
            <p class="text-muted">æµ‹è¯•Bootstrap 5æ¨¡æ€æ¡†çš„å„ç§è°ƒç”¨æ–¹å¼</p>
            
            <div class="card">
                <div class="card-body">
                    <h5 class="card-title">æµ‹è¯•æŒ‰é’®</h5>
                    
                    <!-- åŸç”ŸBootstrap 5æ–¹å¼ -->
                    <button type="button" class="btn btn-primary me-2" data-bs-toggle="modal" data-bs-target="#testModal1">
                        åŸç”ŸBootstrap 5
                    </button>
                    
                    <!-- jQueryæ–¹å¼ -->
                    <button type="button" class="btn btn-success me-2" onclick="$('#testModal2').modal('show')">
                        jQueryæ–¹å¼
                    </button>
                    
                    <!-- JavaScriptæ–¹å¼ -->
                    <button type="button" class="btn btn-info me-2" onclick="showModal3()">
                        JavaScriptæ–¹å¼
                    </button>
                    
                    <!-- å·¥å…·å‡½æ•°æ–¹å¼ -->
                    <button type="button" class="btn btn-warning me-2" onclick="ModalFix.show('testModal4')">
                        å·¥å…·å‡½æ•°æ–¹å¼
                    </button>
                    
                    <hr>
                    
                    <h6>æ‰¹é‡æ“ä½œ</h6>
                    <button type="button" class="btn btn-secondary me-2" onclick="ModalFix.hideAll()">
                        å…³é—­æ‰€æœ‰æ¨¡æ€æ¡†
                    </button>
                    
                    <button type="button" class="btn btn-outline-primary" onclick="testAllModals()">
                        æµ‹è¯•æ‰€æœ‰æ¨¡æ€æ¡†
                    </button>
                </div>
            </div>
            
            <div class="mt-3">
                <h6>æ§åˆ¶å°æ—¥å¿—</h6>
                <div id="logOutput" class="border p-3 bg-light" style="height: 200px; overflow-y: auto; font-family: monospace; font-size: 12px;">
                    <!-- æ—¥å¿—è¾“å‡ºåŒºåŸŸ -->
                </div>
            </div>
        </div>
    </div>
</div>

<!-- æµ‹è¯•æ¨¡æ€æ¡†1 - åŸç”ŸBootstrap 5 -->
<div class="modal fade" id="testModal1" tabindex="-1" aria-labelledby="testModal1Label" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="testModal1Label">åŸç”ŸBootstrap 5æ¨¡æ€æ¡†</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                è¿™æ˜¯ä½¿ç”¨åŸç”ŸBootstrap 5æ–¹å¼æ‰“å¼€çš„æ¨¡æ€æ¡†ã€‚
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">å…³é—­</button>
            </div>
        </div>
    </div>
</div>

<!-- æµ‹è¯•æ¨¡æ€æ¡†2 - jQueryæ–¹å¼ -->
<div class="modal fade" id="testModal2" tabindex="-1" aria-labelledby="testModal2Label" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="testModal2Label">jQueryæ–¹å¼æ¨¡æ€æ¡†</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                è¿™æ˜¯ä½¿ç”¨jQueryæ–¹å¼æ‰“å¼€çš„æ¨¡æ€æ¡†ã€‚
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" onclick="$('#testModal2').modal('hide')">å…³é—­</button>
            </div>
        </div>
    </div>
</div>

<!-- æµ‹è¯•æ¨¡æ€æ¡†3 - JavaScriptæ–¹å¼ -->
<div class="modal fade" id="testModal3" tabindex="-1" aria-labelledby="testModal3Label" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="testModal3Label">JavaScriptæ–¹å¼æ¨¡æ€æ¡†</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                è¿™æ˜¯ä½¿ç”¨JavaScriptæ–¹å¼æ‰“å¼€çš„æ¨¡æ€æ¡†ã€‚
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" onclick="hideModal3()">å…³é—­</button>
            </div>
        </div>
    </div>
</div>

<!-- æµ‹è¯•æ¨¡æ€æ¡†4 - å·¥å…·å‡½æ•°æ–¹å¼ -->
<div class="modal fade" id="testModal4" tabindex="-1" aria-labelledby="testModal4Label" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="testModal4Label">å·¥å…·å‡½æ•°æ–¹å¼æ¨¡æ€æ¡†</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                è¿™æ˜¯ä½¿ç”¨å·¥å…·å‡½æ•°æ–¹å¼æ‰“å¼€çš„æ¨¡æ€æ¡†ã€‚
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" onclick="ModalFix.hide('testModal4')">å…³é—­</button>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
// æ—¥å¿—è¾“å‡ºå‡½æ•°
function log(message) {
    const logOutput = document.getElementById('logOutput');
    const timestamp = new Date().toLocaleTimeString();
    logOutput.innerHTML += `[${timestamp}] ${message}\n`;
    logOutput.scrollTop = logOutput.scrollHeight;
    console.log(message);
}

// JavaScriptæ–¹å¼æ˜¾ç¤ºæ¨¡æ€æ¡†
function showModal3() {
    try {
        const modal = new bootstrap.Modal(document.getElementById('testModal3'));
        modal.show();
        log('âœ… JavaScriptæ–¹å¼æ˜¾ç¤ºæ¨¡æ€æ¡†æˆåŠŸ');
    } catch (error) {
        log('âŒ JavaScriptæ–¹å¼æ˜¾ç¤ºæ¨¡æ€æ¡†å¤±è´¥: ' + error.message);
    }
}

// JavaScriptæ–¹å¼éšè—æ¨¡æ€æ¡†
function hideModal3() {
    try {
        const modal = bootstrap.Modal.getInstance(document.getElementById('testModal3'));
        if (modal) {
            modal.hide();
            log('âœ… JavaScriptæ–¹å¼éšè—æ¨¡æ€æ¡†æˆåŠŸ');
        }
    } catch (error) {
        log('âŒ JavaScriptæ–¹å¼éšè—æ¨¡æ€æ¡†å¤±è´¥: ' + error.message);
    }
}

// æµ‹è¯•æ‰€æœ‰æ¨¡æ€æ¡†
function testAllModals() {
    log('ğŸš€ å¼€å§‹æµ‹è¯•æ‰€æœ‰æ¨¡æ€æ¡†...');
    
    // æµ‹è¯•1: åŸç”ŸBootstrap 5
    setTimeout(() => {
        try {
            const modal1 = new bootstrap.Modal(document.getElementById('testModal1'));
            modal1.show();
            log('âœ… æµ‹è¯•1: åŸç”ŸBootstrap 5 - æˆåŠŸ');
            
            setTimeout(() => modal1.hide(), 1000);
        } catch (error) {
            log('âŒ æµ‹è¯•1: åŸç”ŸBootstrap 5 - å¤±è´¥: ' + error.message);
        }
    }, 500);
    
    // æµ‹è¯•2: jQueryæ–¹å¼
    setTimeout(() => {
        try {
            $('#testModal2').modal('show');
            log('âœ… æµ‹è¯•2: jQueryæ–¹å¼ - æˆåŠŸ');
            
            setTimeout(() => $('#testModal2').modal('hide'), 1000);
        } catch (error) {
            log('âŒ æµ‹è¯•2: jQueryæ–¹å¼ - å¤±è´¥: ' + error.message);
        }
    }, 2000);
    
    // æµ‹è¯•3: å·¥å…·å‡½æ•°æ–¹å¼
    setTimeout(() => {
        try {
            ModalFix.show('testModal4');
            log('âœ… æµ‹è¯•3: å·¥å…·å‡½æ•°æ–¹å¼ - æˆåŠŸ');
            
            setTimeout(() => ModalFix.hide('testModal4'), 1000);
        } catch (error) {
            log('âŒ æµ‹è¯•3: å·¥å…·å‡½æ•°æ–¹å¼ - å¤±è´¥: ' + error.message);
        }
    }, 4000);
    
    setTimeout(() => {
        log('ğŸ‰ æ‰€æœ‰æµ‹è¯•å®Œæˆ');
    }, 6000);
}

// é¡µé¢åŠ è½½å®Œæˆåçš„åˆå§‹åŒ–
$(document).ready(function() {
    log('ğŸ“„ æ¨¡æ€æ¡†æµ‹è¯•é¡µé¢å·²åŠ è½½');
    log('ğŸ”§ jQueryç‰ˆæœ¬: ' + $.fn.jquery);
    log('ğŸ”§ Bootstrapå¯ç”¨: ' + (typeof bootstrap !== 'undefined'));
    log('ğŸ”§ ModalFixå¯ç”¨: ' + (typeof ModalFix !== 'undefined'));
    
    // ç›‘å¬æ¨¡æ€æ¡†äº‹ä»¶
    $('.modal').on('show.bs.modal', function(e) {
        log('ğŸ”“ æ¨¡æ€æ¡†å³å°†æ˜¾ç¤º: ' + e.target.id);
    });
    
    $('.modal').on('shown.bs.modal', function(e) {
        log('âœ… æ¨¡æ€æ¡†å·²æ˜¾ç¤º: ' + e.target.id);
    });
    
    $('.modal').on('hide.bs.modal', function(e) {
        log('ğŸ”’ æ¨¡æ€æ¡†å³å°†éšè—: ' + e.target.id);
    });
    
    $('.modal').on('hidden.bs.modal', function(e) {
        log('âœ… æ¨¡æ€æ¡†å·²éšè—: ' + e.target.id);
    });
});
</script>
{% endblock %}
